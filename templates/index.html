<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <title>ReViews | Inicia sesión</title>
    <script src="https://accounts.google.com/gsi/client" async></script>
    <script>
      async function handleCredentialResponse(response) {
        try {
            const res = await fetch("/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ token: response.credential })
          });


            if (res.ok) {
              window.location.href = "/reviews";
            } else {
              const data = await res.json();
              alert("Error de autenticación: " + data.detail);
            }
        } catch (error) {
          console.error("Error:", error);
        }
      }
    </script>
    <style>
      body {
        font-family: "Inter", Arial, sans-serif;
        background: linear-gradient(135deg, #0d6efd 0%, #3b63f6 50%, #0b3b99 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #0f172a;
      }

      
      .card {
        background: #ffffff;
        border-radius: 16px;
        padding: 32px;
        box-shadow: 0 20px 45px rgba(15, 23, 42, 0.2);
        max-width: 520px;
        width: 100%;
        text-align: center;
      }

      h1 {
        margin: 0;
        font-size: 2rem;
        color: #0f172a;
      }

      p {
        color: #334155;
        line-height: 1.5;
      }

      .features {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
        margin: 24px 0;
        text-align: left;
      }

      .feature {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 12px 14px;
      }

      .feature strong {
        display: block;
        color: #0f172a;
      }

      .signin-btn {
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>ReViews</h1>
      <p>Inicia sesión con tu cuenta de Google para explorar reseñas geolocalizadas, ver detalles de los tokens OAuth usados y crear tus propias valoraciones con imágenes.</p>

      <div class="features">
        <div class="feature">
          <strong>OAuth 2.0</strong>
          Login obligatorio y sesiones seguras.
        </div>
        <div class="feature">
          <strong>Mapas</strong>
          Marcadores con coordenadas obtenidas por geocoding.
        </div>
        <div class="feature">
          <strong>Reseñas</strong>
          Valoraciones de 0 a 5 con fotos y datos del autor.
        </div>
        <div class="feature">
          <strong>Tokens</strong>
          Visualiza el token, fecha de emisión y caducidad.
        </div>
      </div>

      <div
        id="g_id_onload"
        data-auto_prompt="false"
        data-callback="handleCredentialResponse"
        data-client_id="{{ client_id }}"
      ></div>
      <!-- Botón estándar de Google Sign-In -->
      <div
        class="g_id_signin"
        data-type="standard"
        data-shape="rectangular"
        data-theme="outline"
        data-text="sign_in_with"
        data-size="large"
        data-logo_alignment="left"
      ></div>

      <noscript>
        <p style="color: #b91c1c; margin-top: 12px;">Activa JavaScript para iniciar sesión con Google.</p>
      </noscript>
    </div>
  </body>
</html>
